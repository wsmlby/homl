services:
  homl-server:
    image: ${HOML_DOCKER_IMAGE}
    restart: always
    user: "${UID}:${GID}"
    environment:
      - HF_HOME=/models
      - HOML_INSECURE_SOCKET=${HOML_INSECURE_SOCKET}
      - HOME=/models/home/
      - VLLM_SKIP_P2P_CHECK=1
    volumes:
      - "${SOCKET_VOLUME_PATH}:/var/run/homl"
      - "${MODEL_CACHE_PATH}:/models"
      - "${PWD_PATH}:/etc/passwd"
    pid: "host"
    ports:
      - "7456:8080"
    deploy: ${HOML_DEPLOY_RESOURCES}
